<%# Lista de autores com paginação e visual moderno %>
<% content_for :title, "Autores" %>

<div class="w-full max-w-3xl mx-auto py-8">
  <div class="flex justify-between items-center mb-6">
    <h1 class="font-bold text-3xl text-stone-800">Autores</h1>
    <%= link_to "Novo autor", new_author_path, class: "rounded-md px-3.5 py-2.5 bg-blue-600 hover:bg-blue-500 text-white font-medium" %>
  </div>

  <div class="bg-white rounded-lg shadow divide-y divide-stone-200">
    <% if @authors.any? %>
      <table class="min-w-full">
        <thead>
          <tr class="bg-stone-100 text-stone-700 text-left">
            <th class="px-4 py-3 font-semibold">Nome</th>
            <th class="px-4 py-3 font-semibold">Instituição</th>
            <th class="px-4 py-3"></th>
          </tr>
        </thead>
        <tbody>
          <% @authors.each do |author| %>
            <tr class="hover:bg-stone-50 border-b last:border-b-0">
              <td class="px-4 py-3">
                <%= link_to author.name, author_path(author), class: "text-blue-700 hover:underline font-medium" %>
              </td>
              <td class="px-4 py-3 text-stone-700">
                <%= author.institutional_affiliation.presence || '-' %>
              </td>
              <td class="px-4 py-3 text-right">
                <%= link_to 'Ver', author_path(author), class: 'text-stone-500 hover:text-blue-700 underline text-sm' %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% else %>
      <p class="text-center my-10 text-stone-500">Nenhum autor encontrado.</p>
    <% end %>
  </div>

  <div class="mt-6 flex justify-center">
    <% if defined?(@pagy) %>
      <nav class="inline-flex gap-1" aria-label="Paginação">
        <% pagy_nav(@pagy).scan(/<a[^>]*>.*?<\/a>|<span[^>]*>.*?<\/span>/).each do |el| %>
          <% if el.include?('pagy-nav-page') && el.include?('active') %>
            <span class="px-3 py-1 rounded bg-blue-600 text-white font-bold"> <%= raw el.gsub(/<.*?>/, '') %> </span>
          <% elsif el.include?('pagy-nav-page') %>
            <%= raw el.gsub('pagy-nav-page', 'px-3 py-1 rounded bg-stone-100 hover:bg-stone-200 text-stone-700') %>
          <% elsif el.include?('pagy-nav-prev') || el.include?('pagy-nav-next') %>
            <%= raw el.gsub('pagy-nav-', '').gsub('prev', 'px-3 py-1 rounded bg-stone-100 hover:bg-stone-200 text-stone-700').gsub('next', 'px-3 py-1 rounded bg-stone-100 hover:bg-stone-200 text-stone-700') %>
          <% else %>
            <%= raw el %>
          <% end %>
        <% end %>
      </nav>
    <% end %>
  </div>
</div>
